<!DOCTYPE HTML><html><head><meta charset="utf-8"><meta name="viewport" content="with=device-width, initial-scale=1.0"><title>Lucas DiCioccio&#39;s blog - Halogen ECharts Simple</title><link rel="icon" type="image/x-icon" href="/images/favicon.png"><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml"><meta name="author" content="Lucas DiCioccio"><meta name="keywords" content="purescript, open-source, charting, web applications"><meta name="description" content="A demo of a [ECharts-for-Halogen](https://github.com/lucasdicioccio/purescript-halogen-echarts-simple) library."><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Lucas DiCioccio&#39;s blog - Halogen ECharts Simple"><meta name="twitter:site" content="@lucasdicioccio"><meta name="twitter:creator" content="@lucasdicioccio"><meta property="twitter:description" content="A demo of a [ECharts-for-Halogen](https://github.com/lucasdicioccio/purescript-halogen-echarts-simple) library."><meta name="type" property="og:type" content="article"><meta name="title" property="og:title" content="Lucas DiCioccio&#39;s blog - Halogen ECharts Simple"><meta name="url" property="og:url" content="https://lucasdicioccio.github.io/halogen-echarts-example.html"><meta property="og:description" content="A demo of a [ECharts-for-Halogen](https://github.com/lucasdicioccio/purescript-halogen-echarts-simple) library."><meta name="article:published_time" content="2022-12-10T01:00:00Z"><meta name="ks:article_json" content="/json/halogen-echarts-example.cmark.json"><meta name="article:tag" content="purescript"><meta name="article:tag" content="open-source"><meta name="article:tag" content="charting"><meta name="article:tag" content="web applications"><style>@import "/css/main.css";</style></head><body><nav id="site-navigation" class="nav"><a href="/">home</a><div id="search-box"><script type="text/javascript" src="/js/search-box.js" async></script></div></nav><div class="main"><article><header class="heading"><h1>Halogen ECharts Simple</h1><p>On <span>Sat, 10 Dec 2022</span>, by <a href="https://twitter.com/lucasdicioccio">@lucasdicioccio</a>, 548 words, 4 code snippets, 5 links, 0images.</p><div class="taglist"><div class="tag"><a class="tag-link" href="/topics/purescript.html"><span class="tag-name">purescript</span><span class="tag-count">2/2</span></a><div class="tag-prevnext"><span class="tag-prev-link"><a href="/halogen-demo.html">[prev]</a></span><span class="tag-next-link"></span></div></div><div class="tag"><a class="tag-link" href="/topics/open-source.html"><span class="tag-name">open-source</span><span class="tag-count">1/1</span></a><div class="tag-prevnext"><span class="tag-prev-link"></span><span class="tag-next-link"></span></div></div></div></header><div class="main-article"><section class="main-section"><div id="example-err">
</div>
<p>This page is a demonstration of a <a href="https://github.com/lucasdicioccio/purescript-halogen-echarts-simple">ECharts-for-Halogen</a> library I published. The library spawned out of this very-blog (or rather, from <a href="kitchensink-tech.github.io/">Kitchen-Sink</a>) to display the page graph on the home page.</p>
<h2 id="installation">Installation</h2>
<p>Assuming you use <code>npm</code> and <code>spago</code>.</p>
<pre><code class="language-console">npm i echarts
spago install halogen-echarts-simple
</code></pre>
<h2 id="usage">Usage</h2>
<p>The <code>simple</code> in the title means that we provide a very simple layer. That is,
you have to fill in the blanks.</p>
<p>What this library offers is a function to return Halogen components provided that you teach it:</p>
<ul>
<li>(a) what is the type of the <code>options</code> object passed to EChart
</li>
<li>(b) what sort of click-callback objects you care to capture
</li>
</ul>
<p>The <code>type Options o = {|o}</code> definition embodies the <code>(a)</code> above.
The <code>type Output i = {|i}</code> definition embodies the <code>(b)</code> above.</p>
<p>You thus need some boilerplate work to type and translate the various ECharts
datatypes (with its flurry of possible branches). That is, rather than trying
to build a all-you-can-eat-buffet type that would match every ‘options’, we
prefer to restrict ourselves to <em>simple</em> situations where a given graph has
exactly one type. Besides the boilerplate, there probably are limitations (I
have not tried the most advanced charts options involving JavaScript functions
yet). For situations where the ECharts options merely are uniform data, the
boilerplate work should be pretty straightforward.</p>
<h2 id="example-simple-line-chart">example: simple line chart</h2>
<p>Here we start translating <a href="https://echarts.apache.org/examples/en/editor.html?c=line-simple">the line-simple example</a>.</p>
<h3 id="purescript-definitions">Purescript definitions</h3>
<p>We need two things to make the example work: a Slot for your Halogen component, and a type to teach PureScript what is the shape of the <code>options</code> object for ECharts.</p>
<pre><code class="language-purescript">type Slots =
  ( echarts :: forall query output. H.Slot query output Unit 
  )
_echarts = Proxy :: Proxy &quot;echarts&quot;

type SimpleExampleOptions =
  { xAxis :: { type :: String, data :: Array String }
  , yAxis :: { type :: String }
  , series :: Array { data :: Array Int, type :: String }
  }
</code></pre>
<h3 id="single-line">single line</h3>
<p>Then we can call <code>ECharts.component</code> to turn options into an Halogen Component, which you include in a Slot thanks to the <code>HH.slot_</code> function.</p>
<p>Thus, the rendering function for your enclosing component needs to call <code>ECharts.components</code>.</p>
<pre><code>  render0 =
      let
        obj :: SimpleExampleOptions
        obj =
          { xAxis: {type: &quot;category&quot;, data: [&quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;]}
          , yAxis: {type: &quot;value&quot;}
          , series: [{type: &quot;line&quot;, data: [150, 230, 224, 218, 135, 147, 260]}]
          }
      in
      HH.div_
      [ HH.text &quot;echarts simple-line example&quot;
      , HH.slot_ _echarts unit ECharts.component {options: obj, modified:false}
      ]
</code></pre>
<div id="example-0">
</div>
<script src="/js/halogen-echarts-example.js"  data-humdrum-arg="0"></script>
<h3 id="two-lines">two lines</h3>
<pre><code class="language-purescript">    render1 =
      let
        obj :: SimpleExampleOptions
        obj =
          { xAxis: {type: &quot;category&quot;, data: [&quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;]}
          , yAxis: {type: &quot;value&quot;}
          , series:
            [{type: &quot;line&quot;, data: [150, 230, 224, 218, 135, 147, 260]}
            ,{type: &quot;line&quot;, data: [250, 130, 254, 318, 137, 247, 160]}
            ]
          }
      in
      HH.div_
      [ HH.text &quot;echarts simple-line example with two data-lines&quot;
      , HH.slot_ _echarts unit ECharts.component {options: obj, modified:false}
      ]
</code></pre>
<div id="example-1">
</div>
<script src="/js/halogen-echarts-example.js"  data-humdrum-arg="1"></script>
<h2 id="the-modified--bool-input-parameter">the <code>modified :: Bool</code> Input parameter</h2>
<p>From the above example you may have noticed that the Input object requires
extra information.  In particular, the <code>modified</code> boolean allows you to tune whether you want
to re-render the graph each time the component is re-rendered or only using the
explicit Query-ing mechanism that Halogen offers.  Typically you will hardcode
the <code>modified</code> value depending on how often component re-renders are in your
application.</p>
<h2 id="full-source-code">full source-code</h2>
<p>You’ll find the full source-code of the generated JavaScript in a <a href="/gen/out/halogen-echarts-example.cmark__Main.purs">separate file</a>.</p>
<p>The source-code uses <a href="https://github.com/lucasdicioccio/purescript-humdrum">HumDrum</a> to be able to insert a same JS file one time per different example.</p>
<p><strong>want more examples? contact me</strong></p>
</section></div><footer class="footing"><div class="social-links"><a href="https://twitter.com/lucasdicioccio">twitter</a><a rel="me" href="https://fosstodon.org/@lucasdicioccio">mastodon</a><a href="https://cohost.org/lucasdicioccio">cohost</a><a href="https://github.com/lucasdicioccio">github</a><a href="https://linkedin.com/in/lucasdicioccio">linkedin</a></div></footer></article></div></body></html>